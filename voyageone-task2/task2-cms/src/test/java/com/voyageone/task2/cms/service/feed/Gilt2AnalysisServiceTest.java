package com.voyageone.task2.cms.service.feed;

import com.voyageone.common.util.JacksonUtil;
import com.voyageone.common.util.JsonUtil;
import com.voyageone.components.gilt.bean.GiltPageGetSkusRequest;
import com.voyageone.components.gilt.bean.GiltSizeChart;
import com.voyageone.components.gilt.bean.GiltSku;
import com.voyageone.components.gilt.service.GiltSizeChartService;
import com.voyageone.components.gilt.service.GiltSkuService;
import com.voyageone.service.impl.cms.CmsMtGiltSizeChartService;
import com.voyageone.service.model.cms.mongo.CmsMtGiltSizeChartModel;
import com.voyageone.task2.base.dao.TaskDao;
import com.voyageone.task2.base.modelbean.TaskControlBean;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

import java.util.List;

/**
 * @author james.li on 2016/3/21.
 * @version 2.0.0
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("classpath:context-cms-test.xml")
public class Gilt2AnalysisServiceTest {

    @Autowired
    GiltAnalysisService gilt2AnalysisService;
    @Autowired
    private TaskDao taskDao;

    @Autowired
    GiltSizeChartService giltSizeChartService;

    @Autowired
    private GiltSkuService giltSkuService;

    @Autowired
    CmsMtGiltSizeChartService cmsMtGiltSizeChartService;

    @Test
    public void testOnStartup() throws Exception {

        List<TaskControlBean> taskControlList = taskDao.getTaskControlList("Cms2GiltAnalysisJob");
        gilt2AnalysisService.onStartup(taskControlList);
    }



    @Test
    public void testPageGetSkus() throws Exception {

        GiltPageGetSkusRequest request = new GiltPageGetSkusRequest();
        request.setLimit(2);
        request.setOffset(1);
        request.setSku_ids("2631568");

        List<GiltSku> skus = giltSkuService.pageGetSkus(request);
        System.out.println("Retrun:" + JsonUtil.getJsonString(skus));
    }

    @Test
    public void test(){
        String id[] = {"1","10001","10002","10003","10004","10005","10006","10007","10008","10009","10010","10011","10012","10027","10028","10029","10038","10039","10040","10041","10045","10047","10048","10049","10050","10069","10070","10074","10075","10076","10077","10078","10079","10080","10081","10082","10083","10084","10085","10086","10087","10088","10089","10092","10093","10096","10097","10098","10100","10103","10104","10110","10111","10112","10113","10116","10117","10118","10120","10123","10131","10132","10134","10135","10139","10140","10144","10147","10153","10163","10169","10170","10177","10181","10182","10184","10185","10216","10220","10222","10229","10244","10274","10275","10281","10284","10285","10286","10287","10292","10306","10309","10315","10316","10333","10334","10335","10345","10348","10349","10350","10351","10373","10374","10381","10387","10388","10407","10417","10418","10430","10431","10433","10455","10465","10467","10470","10484","10498","10529","10530","10538","10555","10558","10582","10583","10588","10596","10598","10603","10607","10618","10622","10625","10649","10653","10661","10667","10669","10671","10676","10686","10709","10731","10776","10829","10830","10839","10842","10882","10917","10918","10928","10929","10933","10935","10953","10954","10968","10989","10994","10996","11019","11034","11050","11071","11081","11089","11091","11092","11104","11134","11174","11213","11214","11215","11216","11217","11231","11289","11290","11317","11330","11355","11366","11367","11377","11378","11379","11389","11395","11399","11406","11408","11442","11443","11454","11471","11487","11488","11499","11530","11542","11565","11570","11594","11595","11608","11610","11615","11617","11638","11644","11664","11676","11693","11697","11738","11739","11748","11762","11777","11781","11783","11828","11829","11846","11860","11867","11984","11998","12028","12042","12054","12060","12063","12072","12083","12091","12137","12163","12192","12193","12195","12232","12233","12234","12242","12243","12245","12246","12247","12254","12270","12276","12303","12326","12362","12384","12401","12404","12409","12410","12411","12413","12419","12432","12457","12458","12459","12472","12473","12480","12489","12495","12497","12498","12501","12505","12506","12509","12510","12512","12517","12520","12530","12551","12552","12568","12569","12572","12578","12590","12599","12601","12604","12610","12612","12616","12617","12620","12622","12624","12625","12627","12629","12630","12631","12632","12633","12634","12641","12642","12655","12698","12702","12703","12704","12705","12715","12730","12766","12775","12783","12785","12791","12817","12819","12820","12821","12824","12825","12826","12834","12883","12931","12945","12955","12957","12961","12975","12979","12982","12984","12985","12988","12992","13001","13006","13013","13022","13023","13031","13034","13043","13050","13060","13062","13066","13088","13104","13105","13108","13110","13113","13118","13120","13129","13135","13137","13139","13140","13141","13147","13153","13168","13177","13178","13184","13185","13187","13188","13190","13195","13200","13205","13216","13220","13231","13267","13268","13269","13299","13300","13305","13320","13324","13327","13338","13339","13359","13360","13364","13373","13374","13379","13407","13417","13478","13479","13504","13526","13528","13547","13561","13562","13586","13630","13646","13647","13656","13687","13692","13716","13718","13719","13740","13753","13815","13844","13845","13850","13889","13896","13934","13940","13942","13947","13954","13955","13958","13959","13962","13966","13972","13975","13979","13985","13988","13992","13999","14007","14011","14013","14016","14020","14024","14030","14034","14042","14047","14061","14074","14083","14086","14088","14103","14105","14118","14126","14131","14142","14151","14158","14168","14192","14205","14220","14224","14227","14234","14239","14249","14250","14252","14263","14265","14285","14310","14312","14313","14335","14352","14361","14363","14375","14378","14388","14399","14418","14424","14429","14430","14431","14435","14439","14442","14443","14446","14448","14449","14455","14456","14461","14462","14466","14468","14473","14477","14483","14489","14490","14492","14493","14494","14512","14523","14525","14532","14534","14535","14536","14539","14558","14563","14571","14574","14579","14586","14590","14599","14600","14605","14611","14614","14617","14620","14622","14623","14628","14633","14635","14639","14643","14645","14647","14649","14655","14656","14657","14658","14659","14661","14667","14668","14669","14671","14679","14680","14681","14682","14683","14685","14688","14690","14691","14692","14693","14694","14696","14698","14700","14702","14703","14704","14705","14706","14708","14718","14721","14724","14735","14738","14744","14748","14749","14750","14751","14752","14763","14764","14765","14766","14768","14776","14778","14779","14784","14789","14790","14792","14799","14801","14806","14827","14849","14861","14865","14866","14895","14909","14930","14938","14981","15005","15008","15095","15111","15121","15128","15129","15135","15151","15153","15156","15158","15165","15169","15171","15172","15177","15179","15180","15186","15187","15198","15201","15206","15208","15210","15212","15213","15217","15225","15227","15228","15232","15298","15311","15314","15320","15326","15330","15349","15410","15413","15433","15434","15443","15471","15494","15496","15497","15521","15545","15546","15550","15555","15561","15562","15566","15569","15644","15647","15672","15675","15725","15731","15733","15735","15737","15742","15771","15773","15776","15777","15782","15784","15791","15792","15793","15795","15805","15807","15812","15823","15833","15835","15837","15839","15856","15867","15900"};
        try {
            System.out.println(id);
            for(int i=0;i<id.length;i++) {
                GiltSizeChart giltSizeChart = giltSizeChartService.getSizeChartById(id[i]);
                CmsMtGiltSizeChartModel cmsMtGiltSizeChartModel = JacksonUtil.json2Bean(JacksonUtil.bean2Json(giltSizeChart),CmsMtGiltSizeChartModel.class);
                cmsMtGiltSizeChartService.insert(cmsMtGiltSizeChartModel);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}