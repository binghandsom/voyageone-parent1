package com.voyageone.task2.cms.mqjob;

import com.voyageone.common.util.JacksonUtil;
import com.voyageone.service.impl.cms.vomq.vomessage.body.CmsFeedImportMQMessageBody;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

/**
 * Created by gjl on 2017/3/27.
 */
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("classpath:context-cms-test.xml")
public class CmsFeedImportMQJobTest {
    @Autowired
    private CmsFeedImportMQJob cmsFeedImportMQJob;
    @Test
    public void testOnStartup() throws Exception {

        String msg1= "{\"consumerRetryTimes\":0,\"mqId\":0,\"delaySecond\":0,\"sender\":\"VmsGiltAnalysisJob\",\"channelId\":\"015\",\"cmsBtFeedInfoModels\":[{\"_id\":null,\"created\":\"2017-05-12 17:59:06\",\"creater\":\"0\",\"modified\":\"2017-05-12 17:59:06.52\",\"modifier\":\"0\",\"channelId\":\"015\",\"catId\":null,\"category\":\"Apparel-Women apparel-Denim-Skirts\",\"mainCategoryEn\":null,\"mainCategoryCn\":null,\"code\":\"1150492585\",\"name\":\"Cindy Button Front Denim Skirt\",\"model\":\"1150492584\",\"color\":\"denim blue\",\"origin\":\"CHN\",\"sizeType\":\"Women's Dresses & Skirts\",\"sizeChartType\":null,\"image\":[\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403748/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403751/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403757/orig.jpg\"],\"brand\":\"Rachel Antonoff\",\"weight\":\"\",\"shortDescription\":\"\",\"longDescription\":\"Woven cotton skirt<br>* A-line hem<br>* Tonal topstitching and panel seaming <br>* Front button closure<br><b><br>**Measurements:**</b><br>* 33\\\" from waist to hem; taken from a size 4<br>* Model's height is 5 feet 9 inches\",\"skus\":[{\"priceCurrent\":565.0,\"priceMsrp\":1499.0,\"priceNet\":60.45,\"priceClientRetail\":215.0,\"priceClientMsrp\":215.0,\"sku\":\"6147078\",\"size\":\"4 Women's US\",\"barcode\":\"1000061470780\",\"clientSku\":\"6147078\",\"image\":[\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403748/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403751/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403757/orig.jpg\"],\"qty\":4,\"relationshipType\":null,\"variationTheme\":null,\"weightOrg\":\"4\",\"weightOrgUnit\":\"lb\",\"weightCalc\":null,\"isSale\":1,\"mainVid\":null,\"attribute\":{},\"errInfo\":null},{\"priceCurrent\":565.0,\"priceMsrp\":1499.0,\"priceNet\":60.45,\"priceClientRetail\":215.0,\"priceClientMsrp\":215.0,\"sku\":\"6147079\",\"size\":\"6 Women's US\",\"barcode\":\"1000061470797\",\"clientSku\":\"6147079\",\"image\":[\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403748/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403751/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403757/orig.jpg\"],\"qty\":1,\"relationshipType\":null,\"variationTheme\":null,\"weightOrg\":\"4\",\"weightOrgUnit\":\"lb\",\"weightCalc\":null,\"isSale\":1,\"mainVid\":null,\"attribute\":{},\"errInfo\":null},{\"priceCurrent\":565.0,\"priceMsrp\":1499.0,\"priceNet\":60.45,\"priceClientRetail\":215.0,\"priceClientMsrp\":215.0,\"sku\":\"6147081\",\"size\":\"10 Women's US\",\"barcode\":\"1000061470810\",\"clientSku\":\"6147081\",\"image\":[\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403748/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403751/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403757/orig.jpg\"],\"qty\":2,\"relationshipType\":null,\"variationTheme\":null,\"weightOrg\":\"4\",\"weightOrgUnit\":\"lb\",\"weightCalc\":null,\"isSale\":1,\"mainVid\":null,\"attribute\":{},\"errInfo\":null},{\"priceCurrent\":565.0,\"priceMsrp\":1499.0,\"priceNet\":60.45,\"priceClientRetail\":215.0,\"priceClientMsrp\":215.0,\"sku\":\"6147082\",\"size\":\"12 Women's US\",\"barcode\":\"1000061470827\",\"clientSku\":\"6147082\",\"image\":[\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403748/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403751/orig.jpg\",\"https://cdn5.giltcdn.com/images/share/uploads/0000/0005/0840/508403757/orig.jpg\"],\"qty\":1,\"relationshipType\":null,\"variationTheme\":null,\"weightOrg\":\"4\",\"weightOrgUnit\":\"lb\",\"weightCalc\":null,\"isSale\":1,\"mainVid\":null,\"attribute\":{},\"errInfo\":null}],\"attributeList\":null,\"attribute\":{\"attributes_style_name\":[\"ra3165052.db\"],\"attributes_size_type\":[\"Women's Dresses & Skirts\"],\"categories_name\":[\"Skirts\"],\"attributes_material_value\":[\"100% cotton\"],\"attributes_size_size_chart_id\":[\"14691\"],\"name\":[\"Cindy Button Front Denim Skirt\"]},\"attributeVms\":{},\"fullAttribute\":{},\"updFlg\":0,\"updMessage\":\"\",\"clientProductURL\":\"\",\"qty\":0,\"usageEn\":\"\",\"isFeedReImport\":null,\"productType\":\"Skirts\",\"material\":\"\",\"lastReceivedOn\":\"\",\"mpn\":\"ra3165052.db\"}],\"subBeanName\":\"015\"}";
        CmsFeedImportMQMessageBody messageBody = JacksonUtil.json2Bean(msg1, CmsFeedImportMQMessageBody.class);
        cmsFeedImportMQJob.onStartup(messageBody);
    }
}