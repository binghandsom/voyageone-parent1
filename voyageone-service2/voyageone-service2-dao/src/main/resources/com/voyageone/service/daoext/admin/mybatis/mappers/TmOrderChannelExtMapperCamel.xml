<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.voyageone.service.daoext.admin.TmOrderChannelDaoExt">

    <resultMap id="channelModelMap" type="com.voyageone.service.model.admin.TmOrderChannelModel" />
    <resultMap id="channelConfigModelMap" type="com.voyageone.service.model.admin.TmOrderChannelConfigModel" />
    
    <sql id="selectChannelFilter">
    	<where>
            <if test="orderChannelId != null" >
            	and order_channel_id = #{orderChannelId,jdbcType=VARCHAR}
            </if>
            <if test="companyId != null" >
                and company_id = #{companyId,jdbcType=INTEGER}
            </if>
            <if test="channelName != null">
            	and (
            		name = #{channelName,jdbcType=VARCHAR} or full_name = #{channelName,jdbcType=VARCHAR}
            	)
            </if>
            <if test="imgUrl != null" >
                and img_url = #{imgUrl,jdbcType=VARCHAR}
            </if>
            <if test="sendName != null" >
                and send_name = #{sendName,jdbcType=VARCHAR}
            </if>
            <if test="sendAddress != null" >
                and send_address = #{sendAddress,jdbcType=VARCHAR}
            </if>
            <if test="sendTel != null" >
                and send_tel = #{sendTel,jdbcType=VARCHAR}
            </if>
            <if test="sendZip != null" >
                and send_zip = #{sendZip,jdbcType=VARCHAR}
            </if>
            <if test="screctKey != null" >
                and screct_key = #{screctKey,jdbcType=VARCHAR}
            </if>
            <if test="sessionKey != null" >
                and session_key = #{sessionKey,jdbcType=VARCHAR}
            </if>
            <if test="isUsjoi != null" >
                and is_usjoi = #{isUsjoi,jdbcType=INTEGER}
            </if>
            <if test="cartIds != null" >
                and cart_ids = #{cartIds,jdbcType=VARCHAR}
            </if>
            <if test="active != null" >
                and active = #{active,jdbcType=INTEGER}
            </if>
            <if test="created != null" >
                and created = #{created,jdbcType=TIMESTAMP}
            </if>
            <if test="creater != null" >
                and creater = #{creater,jdbcType=VARCHAR}
            </if>
            <if test="modified != null" >
                and modified = #{modified,jdbcType=TIMESTAMP}
            </if>
            <if test="modifier != null" >
                and modifier = #{modifier,jdbcType=VARCHAR}
            </if>
        </where>
    </sql>

	<select id="selectAllCompany" resultType="map">
		select id, company, description, default_view, active, created, creater, modified, modifier from ct_company
	</select>
	
	<select id="selectChannelByPage" resultMap="channelModelMap">
		select order_channel_id, company_id, name, full_name, img_url, send_name, send_address, send_tel, send_zip,
			screct_key, session_key, is_usjoi, cart_ids, active, created, creater, modified, modifier
		from tm_order_channel
		<include refid="selectChannelFilter"/>
	</select>
	
	<select id="selectChannelCount" resultType="integer">
		 select count(1) from tm_order_channel
		 <include refid="selectChannelFilter"/>
	</select>
	
	<sql id="selectChanneConfigFilter">
		<where>
            <if test="orderChannelId != null and orderChannelId != ''" >
                order_channel_id = #{orderChannelId,jdbcType=VARCHAR}
            </if>
            <if test="cfgName != null and cfgName != ''" >
                and cfg_name = #{cfgName,jdbcType=VARCHAR}
            </if>
            <if test="cfgVal != null and cfgVal != ''" >
                and (cfg_val1 = #{cfgVal,jdbcType=VARCHAR} or cfg_val2 = #{cfgVal,jdbcType=VARCHAR})
            </if>
            <if test="comment != null and comment != ''" >
                and comment = #{comment,jdbcType=VARCHAR}
            </if>
        </where>
	</sql>
	
	<select id="selectChanneConfigByPage" resultMap="channelConfigModelMap">
		select order_channel_id, cfg_name, cfg_val1, cfg_val2, comment
		from tm_order_channel_config
		<include refid="selectChanneConfigFilter"></include>
	</select>
	
	<select id="selectChannelConfigCount" resultType="integer">
		select count(1)
		from tm_order_channel_config
		<include refid="selectChanneConfigFilter"></include>
	</select>

</mapper>