<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.voyageone.service.daoext.report.BiReportDownloadTaskDaoExt">
    <select id="selectTasksByCreatorId" parameterType="Map" resultType="com.voyageone.service.model.report.BiReportDownloadTaskModel"><![CDATA[
      	select
        task.*
        FROM
    	voyageone_bi_report.bi_report_download_task task
        WHERE 1=1
        ]]>
        <if test="creatorId != null and creatorId != '' ">
            AND task.creator_id=#{creatorId}
        </if>
        <if test="fileName != null and fileName != '' ">
            and task.file_name = #{fileName}
        </if>
        <if test="taskStatus != null and taskStatus != '' ">
           <![CDATA[ and  task.task_status = #{taskStatus} ]]>
        </if>
    </select>


    <select id="selectNoTasksByCreatorId" parameterType="Map" resultType="com.voyageone.service.model.report.BiReportDownloadTaskModel"><![CDATA[
      	select
        task.*
        FROM
    	voyageone_bi_report.bi_report_download_task task
        WHERE 1 = 1
        ]]>
        <if test="creatorId != null and creatorId != '' ">
          AND task.creator_id = #{creatorId}
        </if>
        <if test="fileName != null and fileName != '' ">
            AND task.file_name = #{fileName}
        </if>
        <if test="taskStatus != null and taskStatus != '' ">
            <![CDATA[ and  task.task_status <> #{taskStatus} ]]>
        </if>
    </select>

   <!-- <select id="selectSaleLastYearDayByDate" parameterType="Map" resultType="Double">
        select sum
        from cms_mt_platform_brands
        where channel_id = #{channelId} and cart_id = #{cartId}
        <if test="brandName != null and brandName != ''">
            and brand_name like lower(concat('%', lower(#{brandName}), '%'));
        </if>
    </select>-->
    <select id="selectAmtDateToDate" parameterType="Map" resultType="BigDecimal">
        select SUM(brss.amt)
        from voyageone_bi_report.bi_report_sales_shop_010 brss
        where brss.shop_id= #{shopId}
        <if test="staDate != null and staDate != '' ">
            <![CDATA[ and brss.date>= #{staDate} ]]>
        </if>
        <if test="endDate != null and endDate != '' ">
            <![CDATA[ and brss.date <= #{endDate} ]]>
        </if>
    </select>

</mapper>
