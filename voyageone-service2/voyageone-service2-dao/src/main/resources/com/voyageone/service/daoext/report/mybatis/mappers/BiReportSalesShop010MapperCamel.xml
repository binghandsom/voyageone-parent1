<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.voyageone.service.daoext.report.BiReportSalesShop010DaoExt">
    <select id="selectListByDate" parameterType="Map" resultType="com.voyageone.service.model.report.ShopSalesOfChannel010Model"><![CDATA[
      	select
      	vs.id,
		vs.Name_cn,
		brss.date,
        brss.shop_id,
        brss.orders,
        brss.return_orders,
        brss.qty,
        brss.amt,
        brss.buyers,
        brss.uv,
        brss.pv,
        brss.add_favortite,
        brss.uv_regular,
        brss.on_sale,
        brss.in_stock,
        brss.shipping,
        brss.direct_express,
        brss.not_express_72h,
        brss.dsr_service,
        brss.dsr_describe,
        brss.dsr_express,
        brss.response_rate_48h,
        brss.return_duration_ranking,
        brss.return_quality_ranking,
        brss.return_disputes_rate
        FROM
    	voyageone_bi_report.bi_report_sales_shop_010 brss
        LEFT JOIN voyageone_bi_source.vm_shop vs ON vs.id = brss.shop_id
        WHERE 1=1
        ]]>
        <if test="nameCn != null and nameCn != '' ">
            and vs.name_cn = #{nameCn}
        </if>
        <if test="staDate != null and staDate != '' ">
           <![CDATA[ and  #{staDate} <= brss.date ]]>
        </if>
        <if test="endDate != null and endDate != '' ">
            <![CDATA[ and brss.date  <= #{endDate} ]]>
        </if>

    </select>

   <!-- <select id="selectSaleLastYearDayByDate" parameterType="Map" resultType="Double">
        select sum
        from cms_mt_platform_brands
        where channel_id = #{channelId} and cart_id = #{cartId}
        <if test="brandName != null and brandName != ''">
            and brand_name like lower(concat('%', lower(#{brandName}), '%'));
        </if>
    </select>-->
    <select id="selectAmtDateToDate" parameterType="Map" resultType="BigDecimal">
        select SUM(brss.amt)
        from voyageone_bi_report.bi_report_sales_shop_010 brss
        where brss.shop_id= #{shopId}
        <if test="staDate != null and staDate != '' ">
            <![CDATA[ and brss.date>= #{staDate} ]]>
        </if>
        <if test="endDate != null and endDate != '' ">
            <![CDATA[ and brss.date <= #{endDate} ]]>
        </if>
    </select>

</mapper>
