<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.voyageone.bi.mapper.TaxDetailMapper">

    <!-- 获得fms_cost_tax_detail信息结构 -->
    <resultMap id="taxDetailMap" type="bi.TaxDetailBean">
        <result column="seq" property="seq"/>
        <result column="invoice_num" property="invoice_num"/>
        <result column="main_waybill_num" property="main_waybill_num"/>
        <result column="tax_list_number" property="tax_list_number"/>
        <result column="tracking_no" property="tracking_no"/>
        <result column="tax_actual" property="tax_actual"/>
    </resultMap>

    <!-- 设定fms_cost_tax_detail检索条件 -->
    <sql id="fms_cost_tax_detail_condition">
        <where>
            <if test="invoice_num != null and invoice_num != '' ">
                and invoice_num = #{invoice_num}
            </if>
            <if test="main_waybill_num != null and main_waybill_num != '' ">
                and main_waybill_num = #{main_waybill_num}
            </if>
            <if test="tax_list_number != null and tax_list_number != '' ">
                and tax_list_number = #{tax_list_number}
            </if>
            <if test="tracking_no != null and tracking_no != '' ">
                and tracking_no = #{tracking_no}
            </if>
        </where>
    </sql>

    <sql id="fms_cost_tax_detail_condition_fuzzy">
        <where>
            <if test="invoice_num != null and invoice_num != '' ">
                and invoice_num LIKE CONCAT('%',#{invoice_num},'%' )
            </if>
            <if test="main_waybill_num != null and main_waybill_num != '' ">
                and main_waybill_num LIKE CONCAT('%',#{main_waybill_num},'%' )
            </if>
            <if test="tax_list_number != null and tax_list_number != '' ">
                and tax_list_number LIKE CONCAT('%',#{tax_list_number},'%' )
            </if>
            <if test="tracking_no != null and tracking_no != '' ">
                and tracking_no LIKE CONCAT('%',#{tracking_no},'%' )
            </if>
        </where>
    </sql>

    <!-- 获得fms_cost_tax_detail数量 -->
    <select id="select_count_fms_cost_tax_detail" parameterType="Map" resultType="int">
        select
        count(1)
        from bi_source.fms_cost_tax_detail
        <include refid="fms_cost_tax_detail_condition"/>
    </select>

    <select id="select_record_fms_cost_tax_detail" parameterType="Map"
            resultMap="taxDetailMap">
        SELECT
        seq,
        invoice_num,
        main_waybill_num,
        tax_list_number,
        tracking_no,
        tax_actual
        FROM bi_source.fms_cost_tax_detail
        <include refid="fms_cost_tax_detail_condition"/>
        LIMIT 1
    </select>

    <!-- 检索fms_cost_tax_detail信息 -->
    <select id="select_list_fms_cost_tax_detail" parameterType="Map" resultMap="taxDetailMap">
        SELECT
        seq,
        invoice_num,
        main_waybill_num,
        tax_list_number,
        tracking_no,
        tax_actual
        FROM bi_source.fms_cost_tax_detail
        <include refid="fms_cost_tax_detail_condition_fuzzy"/>
        ORDER BY
        invoice_num,
        seq
        <if test="init_index != null and init_index != '' and get_size != null and get_size != ''">
            LIMIT #{init_index}, #{get_size}
        </if>
    </select>

    <insert id="insert_fms_cost_tax_detail" parameterType="Map">
        INSERT INTO bi_source.fms_cost_tax_detail (
        seq,
        invoice_num,
        main_waybill_num,
        tax_list_number,
        tracking_no,
        tax_actual
        )
        VALUES
        (
        NULL,
        &apos;${TaxDetailBean.invoice_num}&apos;,
        &apos;${TaxDetailBean.main_waybill_num}&apos;,
        &apos;${TaxDetailBean.tax_list_number}&apos;,
        &apos;${TaxDetailBean.tracking_no}&apos;,
        &apos;${TaxDetailBean.tax_actual}&apos;
        )
    </insert>

    <insert id="insert_list_fms_cost_tax_detail" parameterType="Map" useGeneratedKeys="true">
        INSERT INTO bi_source.fms_cost_tax_detail
        <foreach collection="column" index="index" item="columnname" open="(" separator="," close=")">
            ${columnname}
        </foreach>
        VALUES
        <foreach collection="value" index="index" item="TaxDetailBean" separator=",">
            (
            NULL,
            &apos;${TaxDetailBean.invoice_num}&apos;,
            &apos;${TaxDetailBean.main_waybill_num}&apos;,
            &apos;${TaxDetailBean.tax_list_number}&apos;,
            &apos;${TaxDetailBean.tracking_no}&apos;,
            &apos;${TaxDetailBean.tax_actual}&apos;
            )
        </foreach>
    </insert>

    <!-- 检索fms_cost_tax_detail信息 -->
    <delete id="delete_fms_cost_tax_detail" parameterType="Map">
        DELETE FROM bi_master.fms_cost_tax_detail
        <include refid="fms_cost_tax_detail_condition"/>
    </delete>

    <update id="update_fms_cost_tax_detail" parameterType="Map">
        UPDATE bi_source.fms_cost_tax_detail
        SET
        invoice_num = &apos;${TaxDetailBean.invoice_num}&apos;,
        main_waybill_num = &apos;${TaxDetailBean.main_waybill_num}&apos;,
        tax_list_number = &apos;${TaxDetailBean.tax_list_number}&apos;,
        tracking_no = &apos;${TaxDetailBean.tracking_no}&apos;,
        tax_actual = &apos;${TaxDetailBean.tax_actual}&apos;
        <include refid="fms_cost_tax_detail_condition"/>
    </update>

</mapper>
