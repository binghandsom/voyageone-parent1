<!--contents-->
<div class="container bg-white" id="oms_orders_addNewOrder" ng-controller="addNewOrderController" ng-init="initialize()" ng-cloak>
    <form name="formNewOrder" class="form-validate" novalidate="">
        <div class="row">
            <div class="col-xs-4 form-horizontal pl-sm mt-sm" ng-if="isFromOrderDetail">
                <div class="form-group">
                    <label class="col-xs-5 control-label" translate="TXT_ORDER_WEBORDERNUMBBER"></label>

                    <div class="col-xs-7">
                        <input type="text" ng-model="newOrderInfo.sourceOrderId" readonly class="form-control input-sm"/>
                    </div>
                </div>
            </div>
            <div class="col-xs-4 form-horizontal pl-sm mt-sm" ng-if="!isFromOrderDetail">
                <div class="form-group">
                    <label class="col-xs-5 control-label" translate="TXT_OMS_CUSTOMER_SEARCH_STORE"></label>

                    <div class="col-xs-7">
                        <select class="form-control input-sm" ng-model="newOrderInfo.orderChannelId" ng-options="propertyInfo.propertyId as propertyInfo.propertyName for propertyInfo in propertyList" required=""></select>
                    </div>
                </div>
            </div>
            <div class="col-xs-5 pl-sm mt-sm">
                <div class="btn-group">
                    <label ng-model="newOrderInfo.orderKind" btn-radio="orderKind.id" uncheckable="uncheckable" class="btn btn-default" ng-repeat="orderKind in orderKindList" required="" ng-disabled="orderKind.isLeaf" ng-if="orderKind.id != '4'">
                        <span ng-bind="orderKind.name"></span>
                    </label>
                </div>
            </div>
            <div class="col-xs-3 p-sm mt-sm">
                <div class="btn-group-sm ms-fr">
                    <button type="submit" class="btn btn-primary" translate="BUTTON_SAVE" ng-click="doSave()" ng-disabled="formNewOrder.$invalid || orderDetailList.length == 0"></button>
                    <button class="btn btn-primary" translate="BUTTON_CANCEL" ng-click="doCancel()"></button>
                </div>
            </div>
        </div>
        <div class="row p-sm">
            <div id="panelNewOrder" class="panel panel-info mb-sm">
                <div ng-class="{'panel-heading-collapsed':panelNewOrder}" class="panel-heading"><span translate="TXT_ORDER_NEW_ORDER_TITLE"></span>
                    <paneltool tool-collapse="tool-collapse"></paneltool>
                </div>
                <div collapse="panelNewOrder" class="panel-wrapper">
                    <div class="panel-body p-sm">
                        <tabset class="mt-sm p-sm">
                            <tab heading="TXT_ORDER_ADDRESS">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <div class="row mt-sm form-horizontal">
                                            <div class="col-xs-6">
                                                <span class="label label-info mr-lg" translate="TXT_OMS_SOLD_TO"></span>
                                            </div>
                                            <div class="col-xs-6 pr0">
                                                <button class="btn btn-primary btn-sm fa fa-search ms-fr" translate="BUTTON_SEARCH" ng-click="doPopupSearchCustomer()" ng-disabled="newOrderInfo.orderChannelId == null"></button>
                                            </div>
                                        </div>
                                        <div class="row ml-sm mt-sm form-horizontal">
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_ORDER_SHIP_ID_WITH_NAME"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-3 pr-sm">
                                                    <input type="text" ng-model="customerInfo.customerId" readonly class="form-control input-sm"/>
                                                </div>
                                                <div class="col-xs-5 pl0">
                                                    <input type="text" ng-model="customerInfo.lastName" class="form-control input-sm" required=""/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label" translate="TXT_OMS_EMAIL"></label>

                                                <div class="col-xs-8">
                                                    <input type="email" placeholder="test@mail.com" ng-model="customerInfo.email" class="form-control input-sm"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_PHONE"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-8">
                                                    <input type="text" ng-model="customerInfo.phone" class="form-control input-sm" required="" ng-pattern="/^[0-9]+$/"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label" translate="TXT_OMS_COMPANY"></label>

                                                <div class="col-xs-8">
                                                    <input type="text" ng-model="customerInfo.company" class="form-control input-sm"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_ADDRESS_1"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-8">
                                                    <textarea rows="3" ng-model="customerInfo.address" class="form-control input-sm no-resize" required=""/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label" translate="TXT_OMS_ADDRESS_2"></label>

                                                <div class="col-xs-8">
                                                    <textarea rows="3" ng-model="customerInfo.address2" class="form-control input-sm no-resize"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_CITY_STATE_ZIP"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-3 pr-sm">
                                                    <input type="text" ng-model="customerInfo.city" class="form-control input-sm" required=""/>
                                                </div>
                                                <div class="col-xs-3 pl0 pr-sm">
                                                    <input type="text" ng-model="customerInfo.state" class="form-control input-sm" required=""/>
                                                </div>
                                                <div class="col-xs-2 pl0">
                                                    <input type="text" ng-model="customerInfo.zip" class="form-control input-sm" ng-pattern="/^[0-9]+$/"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_COUNTRY"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-8">
                                                    <select class="form-control input-sm" ng-model="customerInfo.country" ng-options="countryInfo.id as countryInfo.name for countryInfo in countryList" required=""></select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-2">
                                        <button class="mt50 btn btn-primary ml20" translate="BUTTON_COPY_FROM_SOLD_TO" ng-click="doCopyFromSoldTo()"></button>
                                    </div>
                                    <div class="col-xs-5">
                                        <div class="row mt-sm form-horizontal">
                                            <div class="col-xs-6">
                                                <span class="label label-info mr-lg" translate="TXT_OMS_SHIP_TO"></span>
                                            </div>
                                        </div>
                                        <div class="row ml-sm mt-sm form-horizontal">
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_NAME"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-8">
                                                    <input type="text" ng-model="shipToInfo.lastName" class="form-control input-sm" required=""/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label" translate="TXT_OMS_EMAIL"></label>

                                                <div class="col-xs-8">
                                                    <input type="email" placeholder="test@mail.com" ng-model="shipToInfo.email" class="form-control input-sm"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_PHONE"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-8">
                                                    <input type="text" ng-model="shipToInfo.phone" class="form-control input-sm" required="" ng-pattern="/^[0-9]+$/"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label" translate="TXT_OMS_COMPANY"></label>

                                                <div class="col-xs-8">
                                                    <input type="text" ng-model="shipToInfo.company" class="form-control input-sm"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_ADDRESS_1"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-8">
                                                    <textarea rows="3" ng-model="shipToInfo.address" class="form-control input-sm no-resize" required=""/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label" translate="TXT_OMS_ADDRESS_2"></label>

                                                <div class="col-xs-8">
                                                    <textarea rows="3" ng-model="shipToInfo.address2" class="form-control input-sm no-resize"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_CITY_STATE_ZIP"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-3 pr-sm">
                                                    <input type="text" ng-model="shipToInfo.city" class="form-control input-sm" required=""/>
                                                </div>
                                                <div class="col-xs-3 pl0 pr-sm">
                                                    <input type="text" ng-model="shipToInfo.state" class="form-control input-sm" required=""/>
                                                </div>
                                                <div class="col-xs-2 pl0">
                                                    <input type="text" ng-model="shipToInfo.zip" class="form-control input-sm" ng-pattern="/^[0-9]*$/"/>
                                                </div>
                                            </div>
                                            <div class="form-group mb-sm">
                                                <label class="col-xs-4 control-label"><span translate="TXT_OMS_COUNTRY"></span><span translate="COMMON_INPUT_MUST"></span></label>

                                                <div class="col-xs-8">
                                                    <select class="form-control input-sm" ng-model="shipToInfo.country" ng-options="countryInfo.id as countryInfo.name for countryInfo in countryList" required=""></select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </tab>
                            <tab heading="TXT_ORDER_COMMENT">
                                <div class="row">
                                    <div class="col-xs-4">
                                        <div class="row mt-sm form-horizontal">
                                            <div class="col-xs-12">
                                                <span class="label label-info mr-lg" translate="TXT_ORDER_CUSTOMER_COMMENT"></span>
                                            </div>
                                        </div>
                                        <div class="row ml-sm mt-sm form-horizontal">
                                            <div class="form-group">
                                                <div class="col-xs-12 pl">
                                                    <textarea rows="10" ng-model="newOrderInfo.customerComment" class="form-control input-sm no-resize"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-4">
                                        <div class="row mt-sm form-horizontal">
                                            <div class="col-xs-12">
                                                <span class="label label-info mr-lg" translate="TXT_ORDER_INTERNAL_MESSAGE"></span>
                                            </div>
                                        </div>
                                        <div class="row ml-sm mt-sm form-horizontal">
                                            <div class="form-group">
                                                <div class="col-xs-12 pl">
                                                    <textarea rows="10" ng-model="newOrderInfo.internalMessage" class="form-control input-sm no-resize"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-4">
                                        <div class="row mt-sm form-horizontal">
                                            <div class="col-xs-12">
                                                <span class="label label-info mr-lg" translate="TXT_ORDER_GIFTMESSAGE"></span>
                                            </div>
                                        </div>
                                        <div class="row ml-sm mt-sm form-horizontal">
                                            <div class="form-group">
                                                <div class="col-xs-12 pl">
                                                    <textarea rows="10" ng-model="newOrderInfo.giftMessage" class="form-control input-sm no-resize"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </tab>
                            <tab heading="TXT_ORDER_INVOICE_INFO">
                                <div class="row">
                                    <div class="col-xs-4">
                                        <div class="row mt-sm form-horizontal">
                                            <div class="col-xs-12">
                                                <span class="label label-info mr-lg" translate="TXT_ORDER_INVOICE_INFO"></span>
                                            </div>
                                        </div>
                                        <div class="row ml-sm mt-sm form-horizontal">
                                            <div class="form-group">
                                                <div class="col-xs-12 pl">
                                                    <textarea rows="10" ng-model="newOrderInfo.invoiceInfo" class="form-control input-sm no-resize"/>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-xs-4 control-label" translate="TXT_ORDER_INVOICE_STATUS"></label>

                                                <div class="col-xs-8">
                                                    <select class="form-control input-sm" ng-model="newOrderInfo.invoice" ng-options="invoiceInfo.id as invoiceInfo.name for invoiceInfo in invoiceStatusList"></select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </tab>
                        </tabset>
                    </div>
                </div>
            </div>
        </div>
        <div class="border-bottom-1"></div>
        <div class="row p-sm">
            <div class="col-xs-9 p-sm pl0">
                <div class="col-xs-12 pl0 mb-sm">
                    <div class="btn-group-sm ms-fr">
                        <button class="btn btn-primary fa fa-search" translate="BUTTON_SEARCH_SKU" ng-click="doPopupSearchSku()" ng-disabled="newOrderInfo.orderChannelId == null"></button>
                        <button no class="btn btn-primary fa fa-trash" translate="BUTTON_SUB_DELETE" ng-click="doDeleteOrderDetail()" ng-disabled="selectOrderDetail.length == 0"></button>
                    </div>
                </div>
                <div class="col-xs-12 pl0">
                    <div class="table-responsive">
                        <table class="table table-bordered mb0">
                            <thead>
                            <tr>
                                <th class="w10p">#</th>
                                <th class="w20p" translate="TXT_ORDER_SKU"></th>
                                <th class="w40p" translate="TXT_ORDER_PRODUCT"></th>
                                <th class="w20p" translate="TXT_ORDER_UNIT_PRICE_DISCOUNT"></th>
                                <th class="w10p" translate="TXT_ORDER_INVENTORY"></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="orderDetailInfo in orderDetailList" multi-on-select="$parent.selectOrderDetail" index="{{$index}}">
                                <td class="w10p" ng-bind="$index + 1"></td>
                                <td class="w20p"><img class="media" show-image="orderDetailInfo.imgPath"/><a href="orderDetailInfo.skuTmallUrl" ng-bind="orderDetailInfo.sku"></a></td>
                                <td class="w40p">
                                    <span ng-bind="orderDetailInfo.product"></span>
                                    <a href="" popover="{{orderDetailInfo.description}}" popover-trigger="mouseenter" class="ms-fr fa fa-book c_green"></a>
                                </td>
                                <td class="text-right pt0 pb0 f8">
                                    <div class="border-bottom-1">
                                        <span ng-bind="orderDetailInfo.pricePerUnit | number:2"></span>
                                        <!--<span ng-if="orderDetailInfo.discount &gt; 0"><span class="c_red">(<span class="fa fa-sort-down" ng-bind="orderDetailInfo.discount | number:2"></span>)</span></span>-->
                                        <span ng-if="orderDetailInfo.discount &lt; 0"><span class="c_green">(<span class="fa fa-sort-asc" ng-bind="-orderDetailInfo.discount | number:2"></span>)</span></span>
                                        <span ng-if="orderDetailInfo.discount &gt; 0"><span class="c_red">(<span class="fa fa-sort-down" ng-bind="orderDetailInfo.discount | number:2"></span>)</span></span>
                                    </div>
                                    <span class="fb c_green" ng-bind="orderDetailInfo.price | number:2"></span>
                                </td>
                                <!--<td class="text-right w20p">-->
                                <!--<span ng-bind="orderDetailInfo.pricePerUnit | number:2"></span>-->
                                <!--<span ng-if="orderDetailInfo.priceDiscount &gt;= 0"><span class="c_green">(<span class="fa fa-sort-asc" ng-bind="orderDetailInfo.priceDiscount | number:2"></span>)</span></span>-->
                                <!--<span ng-if="orderDetailInfo.priceDiscount &lt; 0"><span class="c_red">(<span class="fa fa-sort-down" ng-bind="-orderDetailInfo.priceDiscount | number:2"></span>)</span></span>-->
                                <!--</td>-->
                                <td class="w10p" ng-bind="orderDetailInfo.quantityOrdered"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-xs-3 p-sm">
                <div class="col-xs-12 mb20">
                    <span class="label label-info mr-lg" translate="TXT_ORDER_PRICING"></span>
                </div>
                <div class="col-xs-12 table-responsive">
                    <table class="table">
                        <tbody>
                        <tr>
                            <th class="w40p" scope="row"><span class="ms-fr small" translate="TXT_ORDER_PRODUCT_TOTAL"></span></label></th>
                            <!--<td class="w20p"></td>-->
                            <td class="ml20 w50p text-right" ng-bind="newOrderInfo.productTotal | number:2"></td>
                        </tr>
                        <tr>
                            <th scope="row"><label class="ms-fr small pt7" translate="TXT_ORDER_CHARGES"></label></th>
                            <!--<td></td>-->
                            <td>
                                <!--<input type="text" ng-model="newOrderInfo.surcharge" class="form-control input-sm text-right" ng-blur="calculatePrice()" ng-pattern="/^(-?\d+)(\.[0-9]{0,2})?$/"/>-->
                            </td>
                            <!--<td class="text-right" ng-bind="newOrderInfo.surcharge | number:2"></td>-->
                        </tr>
                        <tr>
                            <th scope="row"><label class="ms-fr small pt7" translate="TXT_OMS_PRODUCT_DISCOUNT"></label></th>
                            <td class="ml20 w50p text-right" ng-bind="-productItemDiscount | number:2"></td>
                        </tr>
                        <tr>
                            <th scope="row"><label class="ms-fr small pt7" translate="TXT_OMS_ORDER_DISCOUNT"></label></th>
                            <!--<td>-->
                            <!--<button class="btn btn-primary btn-xs fa fa-pencil ms-fr" ng-click="doPopupDiscount()"></button>-->
                            <!--</td>-->
                            <td>
                                <div class="input-group">
                                    <span class="input-group-addon">-</span><input type="text" ng-model="newOrderInfo.discount" class="form-control input-sm text-right" ng-blur="calculatePrice()" ng-pattern="/^(-?\d+)(\.[0-9]{0,2})?$/"/>
                                </div>
                            </td>
                            <!--<td class="text-right" ng-bind="newOrderInfo.revisedDiscount | number:2"></td>-->
                        </tr>
                        <tr>
                            <th scope="row"><label class="ms-fr small pt7" translate="TXT_ORDER_COUPON"></label></th>
                            <!--<td></td>-->
                            <td>
                                <!--<input type="text" ng-model="newOrderInfo.couponDiscount" class="form-control input-sm text-right" ng-blur="calculatePrice()" ng-pattern="/^(-?\d+)(\.[0-9]{0,2})?$/"/>-->
                            </td>
                            <!--<td class="text-right" ng-bind="newOrderInfo.couponDiscount | number:2"></td>-->
                        </tr>
                        <tr>
                            <th scope="row"><label class="ms-fr small pt7" translate="TXT_ORDER_SHIPPING"></label></th>
                            <!--<td>-->
                            <!--<button class="btn btn-primary btn-xs fa fa-pencil ms-fr"></button>-->
                            <!--</td>-->
                            <td>
                                <input type="text" ng-model="newOrderInfo.shippingTotal" class="form-control input-sm text-right" ng-blur="calculatePrice()" ng-pattern="/^(-?\d+)(\.[0-9]{0,2})?$/"/>
                            </td>
                        </tr>
                        <tr>
                            <th scope="row"><label class="ms-fr small pt7" translate="TXT_ORDER_GRAND_TOTAL"></label></th>
                            <!--<td></td>-->
                            <td class="text-right c_green"><span class=" f16 fb" ng-bind="newOrderInfo.grandTotal | number:2"></span></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </form>
</div>
