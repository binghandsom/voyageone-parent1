<div class="breadcrumbs" ng-init="ctrl.init()">
    <div class="container">
        <h4 class="pull-left" translate="TXT_ORDER_INFO"></h4>
        <ul class="pull-right breadcrumb">
            <li><a href="#/home" translate="TXT_HOME"></a></li>
            <li class="active disabled" translate="TXT_ORDER"></li>
            <li class="active selecte" translate="TXT_ORDER_INFO"></li>
        </ul>
    </div>
</div>
<div class="container content">
    <div class="panel panel-default">
        <div class="panel-body">
            <div class="form-inline">
                <div class="form-group">
                    <!-- ORDER_ID -->
                    <label class="control-label m-l-sm" translate="TXT_ORDER_ID"></label>
                    <input id="ORDER_ID" type="text" class="form-control input-sm" ng-model="ctrl.searchInfo.consolidationOrderId" enter-click="#searchButton">
                    <!-- SKU -->
                    <label class="control-label m-l-sm" translate="TXT_SKU"></label>
                    <input id="SKU" type="text" class="form-control input-sm" ng-model="ctrl.searchInfo.sku" enter-click="#searchButton">
                    <!-- Status -->
                    <label class="control-label m-l-sm" translate="TXT_STATUS"></label>
                    <select name="SKU_STATUS" id="select" class="form-control input-sm" ng-model="ctrl.searchInfo.status"
                            ng-options="orderStatus.value as orderStatus.name for orderStatus in ctrl.orderStatusList">
                        <option value="" translate="TXT_ALL"></option>
                    </select>

                    <label class="control-label" translate="TXT_ORDER_DATE"></label>
                    <span class="input-group">
                        <input name="activityStart" class="form-control input-sm"
                               ng-attr-title="{{'TXT_FROM' | translate}}"
                               type="date"
                               ng-model="ctrl.orderDateFrom"
                               uib-datepicker-popup
                               datepicker-options="{maxDate:ctrl.orderDateTo}"
                               is-open="datepicker3">
                        <span class="input-group-btn">
                            <button class="btn btn-default input-sm" ng-click="datepicker3=!datepicker3"><i class="glyphicon glyphicon-calendar"></i></button>
                        </span>
                    </span>
                    <span>~</span>
                    <span class="input-group">
                        <input name="activityStart" class="form-control input-sm"
                               ng-attr-title="{{'TXT_TO' | translate}}"
                               type="date"
                               ng-model="ctrl.orderDateTo"
                               uib-datepicker-popup
                               datepicker-options="{minDate:ctrl.orderDateFrom}"
                               is-open="datepicker4">
                        <span class="input-group-btn">
                            <button class="btn btn-default input-sm" ng-click="datepicker4=!datepicker4"><i class="glyphicon glyphicon-calendar"></i></button>
                        </span>
                    </span>
                </div>
                <div class="pull-right">
                    <button id="searchButton" ng-click="ctrl.pageInfo.curr=1;ctrl.search()" class="btn btn-primary btn-sm" translate="BTN_SEARCH"></button>
                </div>
            </div>
        </div>
    </div>
    <div class="row margin-bottom-10">
        <div class="col-sm-6" ng-if="ctrl.channelConfigs.vendorOperateType == 'ORDER'">
            <button ng-if="!ctrl.currentShipment" class="btn btn-success btn-sm" ng-click="ctrl.popShipment('new')" translate="BTN_NEW_SHIPMENT"></button>
            <button ng-if="ctrl.currentShipment" class="btn btn-success btn-sm" ng-click="ctrl.popShipment('end')" translate="BTN_END_SHIPMENT"></button>
            <span class="form-text"> {{'TXT_CURRENT_SHIPMENT' | translate}} :
                <a ng-if="ctrl.currentShipment" href="javascript:void(0)" ng-click="ctrl.popShipment('edit')">{{ctrl.currentShipment.shipmentName}}</a>
                <label ng-if="!ctrl.currentShipment" translate="TXT_NO_CURRENT_SHIPMENT"></label></label> </span>
        </div>
        <div class="col-sm-6" ng-if="!(ctrl.channelConfigs.vendorOperateType == 'ORDER')"></div>
        <div class="col-sm-6 text-right form-inline">
            <select id="select_order" class="form-control" ng-model="ctrl.downloadInfo.orderType">
                <option value="client_sku" translate="TXT_ORDER_BY_SKU"></option>
                <option value="order_id" translate="TXT_ORDER_BY_ORDER_ID"></option>
            </select>
            <button class="btn btn-primary btn-sm" ng-click="ctrl.downloadPickingList()" translate="BTN_DOWNLOAD_PICKING_LIST"></button>
        </div>
    </div>
    <div class="panel panel-vo" ng-if="ctrl.channelConfigs.vendorOperateType == 'ORDER'">
        <div class="panel-body">
            <div class="table-responsive" if-no-rows="ctrl.data">
                <table class="table table-vo">
                    <thead>
                    <tr>
                        <th class="text-right" style="width: 30px" ng-click="ctrl.toggleAll()"><i ng-class="{'fa fa-plus': ctrl.collapse, 'fa fa-minus':!ctrl.collapse}"></i></th>
                        <th class="td-1-5" translate="TXT_ORDER_ID"></th>
                        <th class="td-1-5" translate="TXT_ORDER_DATE"></th>
                        <th class="td-1" translate="TXT_SKU"></th>
                        <th class="td-2" translate="TXT_NAME"></th>
                        <th class="td-1" translate="TXT_STATUS"></th>
                        <th class="td-1" translate="TXT_VO_PRICE"></th>
                        <th class="td-1" ng-if="ctrl.channelConfigs.salePriceShow == '1'" translate="TXT_SALE_PRICE"></th>
                        <th class="td-3" translate="TXT_ACTION"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat-start="item in ctrl.data" ng-class="::item.className">
                        <td class="text-right v-middle" ng-click="item.collapse = !item.collapse"><i ng-class="{'fa fa-plus': item.collapse, 'fa fa-minus':!item.collapse}"></i>
                        </td>
                        <td class="v-middle" ng-click="item.collapse = !item.collapse"><strong>{{item.consolidationOrderId}}</strong></td>
                        <td class="v-middle" ng-click="item.collapse = !item.collapse"><strong>{{item.consolidationOrderTime | date: 'yyyy-MM-dd HH:mm:ss'}}</strong></td>
                        <td class="v-middle" ng-click="item.collapse = !item.collapse"><strong>-</strong></td>
                        <td class="v-middle" ng-click="item.collapse = !item.collapse"><strong>-</strong></td>
                        <td class="v-middle" ng-click="item.collapse = !item.collapse"><strong>{{ctrl.getStatusName(item.status)}}</strong></td>
                        <td class="v-middle" ng-click="item.collapse = !item.collapse"><strong>${{item.totalVoPrice}}</strong></td>
                        <td class="v-middle" ng-if="ctrl.channelConfigs.salePriceShow == '1'" ng-click="item.collapse = !item.collapse"><strong>¥{{item.totalRetailPrice}}</strong>
                        </td>
                        <td class="v-middle">
                            <button class="btn btn-xs btn-danger" ng-if="item.status == 1"
                                    ng-click="ctrl.cancelOrder(item)" translate="BTN_CANCEL"></button>
                            <button class="btn btn-xs btn-info" ng-if="item.status == 1"
                                    ng-click="ctrl.popAddToShipment(item)" ng-disabled="!ctrl.currentShipment"
                                    translate="BTN_ADD_TO_SHIPMENT"></button>
                        </td>
                    </tr>
                    <tr ng-if="!item.collapse" ng-class="::item.subClassName" ng-repeat="detail in item.orderInfoBeanList" ng-repeat-end>
                        <td class="v-middle"></td>
                        <td class="v-middle"></td>
                        <td class="v-middle">{{detail.consolidationOrderTime| date: 'yyyy-MM-dd HH:mm:ss'}}</td>
                        <td class="v-middle">{{detail.clientSku}}</td>
                        <td class="v-middle">
                            <span ng-if="detail.name.length <= 25">{{detail.name}}</span>
                            <span ng-if="detail.name.length > 25" uib-tooltip="{{detail.name}}" tooltip-trigger="mouseenter" tooltip-placement="top">{{detail.name | stringCutter:true:25:' ...'}}</span>
                        </td>
                        <td class="v-middle">{{ctrl.getStatusName(detail.status)}}</td>
                        <td class="v-middle">${{detail.voPrice}}</td>
                        <td class="v-middle" ng-if="ctrl.channelConfigs.salePriceShow == '1'">¥{{detail.salePrice}}</td>
                        <td class="v-middle"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-sm-12 m-t-lg no-padding">
                <vpagination config="ctrl.pageInfo" total="ctrl.pageInfo.total"></vpagination>
            </div>
        </div>
    </div>
    <div class="panel panel-vo" ng-if="ctrl.channelConfigs.vendorOperateType == 'SKU'">
        <div class="panel-body">
            <div class="table-responsive" if-no-rows="ctrl.data">
                <table class="table table-fixed table-vo">
                    <thead>
                    <tr>
                        <!--<th class="text-right" style="width: 30px" ng-click="ctrl.toggleAll()" ng-bind="ctrl.collapse ? '+' : '-'"></th>-->
                        <th class="td-1-5" translate="TXT_ORDER_ID"></th>
                        <th class="td-1-5" translate="TXT_ORDER_DATE"></th>
                        <th class="td-1" translate="TXT_SKU"></th>
                        <th class="td-3" translate="TXT_NAME"></th>
                        <th class="td-1" translate="TXT_STATUS"></th>
                        <th class="td-1" translate="TXT_VO_PRICE"></th>
                        <th ng-if="ctrl.channelConfigs.salePriceShow == '1'" class="td-1" translate="TXT_SALE_PRICE"></th>
                        <th class="td-2" translate="TXT_ACTION"></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="item in ctrl.data" ng-class="::item.className">
                        <!--<td class="text-right" ng-click="item.collapse = !item.collapse" ng-bind="item.collapse ? '+' : '-'"></td>-->
                        <td class="v-middle">{{item.consolidationOrderId}}</td>
                        <td class="v-middle">{{item.consolidationOrderTime | date: 'yyyy-MM-dd HH:mm:ss'}}</td>
                        <td class="v-middle">{{item.clientSku}}</td>
                        <td class="v-middle">
                            <span ng-if="item.name.length <= 25">{{item.name}}</span>
                            <span ng-if="item.name.length > 25" uib-tooltip="{{item.name}}" tooltip-trigger="mouseenter" tooltip-placement="top">{{item.name | stringCutter:true:25:' ...'}}</span>
                        </td>
                        <td class="v-middle">{{ctrl.getStatusName(item.status)}}</td>
                        <td class="v-middle">${{item.voPrice}}</td>
                        <td class="v-middle" ng-if="ctrl.channelConfigs.salePriceShow == '1'">¥{{item.salePrice}}</td>
                        <td class="v-middle">
                            <button ng-if="item.status == 1" class="btn btn-xs btn-warning" ng-click="ctrl.cancelSku(item)" translate="BTN_CANCEL"></button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-sm-12 m-t-lg no-padding">
                <vpagination config="ctrl.pageInfo" total="ctrl.pageInfo.total"></vpagination>
            </div>
        </div>
    </div>
</div>