<div class="wrapper-md" ng-controller="feedPropMappingController as ctrl" ng-init="ctrl.init()">
    <tabset class="tab-container vo_nav-tabs">
        <div class="form-inline pull-right">
            <select class="form-control m-r-xxs">
                <option>必填情况(ALL)</option>
                <option>非必填</option>
                <option>必填</option>
            </select>
            <select class="form-control m-r-xxs">
                <option>设定情况(ALL)</option>
                <option>已设定</option>
                <option>未设定</option>
            </select>
            <input type="text" placeholder="快速检索" class="form-control">
            <button type="submit" class="btn btn-vo btn-xxs"><i class="fa fa-search"></i></button>
        </div>
        <tab>
            <tab-heading>类目属性匹配</tab-heading>
            <div class="container-fluid" ng-controller="popupCtrl">
                <div class="col-sm-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">普通属性匹配</h4>
                        </div>
                        <form class="form-horizontal">
                            <div class="form-group m-t-xs feed_mapping_bg"
                                 ng-repeat="field in ctrl.mainCategory.fields | fmExtendField"
                                 ng-include="'feedMapping.field.tpl.html'">
                            </div>
                        </form>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">SKU匹配</h4>
                        </div>
                        <form class="form-horizontal">
                            <div class="form-group"
                                 ng-repeat="field in ctrl.mainCategory.sku | fmExtendField"
                                 ng-include="'feedMapping.field.tpl.html'">
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </tab>
    </tabset>
    <script type="text/ng-template" id="feedMapping.field.tpl.html">
        <label class="col-sm-4 control-label"
               ng-class="{ 'vo_reqfield': field.x.required }">{{ field.name }}</label>

        <div class="col-sm-7 hierarchy" ng-if="!field.x.isSimple">
            <div class="col-sm-4 form-inline m-b-xs"
                 ng-repeat="child in field.fields | fmExtendField:field"
                 ng-include="'feedMapping.multi.setter.tpl.html'">
            </div>
        </div>

        <div class="col-sm-8" ng-if="field.x.isSimple">
            <button class="btn btn-default btn-xs"
                    ng-click="popupFeed(ctrl.popupContext(field)).then(ctrl.saveMapping)">值匹配</button>
        </div>
    </script>
    <script type="text/ng-template" id="feedMapping.multi.setter.tpl.html">
        <div ng-if="!child.x.isSimple"
             ng-repeat="$child in child.fields | fmExtendField:child"
             ng-init="child = $child"
             ng-include="'feedMapping.multi.setter.tpl.html'">
        </div>
        <div ng-if="child.x.isSimple">
            <label class="control-label"
                   ng-class="{ 'vo_reqfield': child.x.required }">{{ child.name }}</label>
            <button class="btn btn-default btn-xs"
                    ng-click="popupFeed(ctrl.popupContext(child)).then(ctrl.saveMapping)">值匹配</button>
        </div>
    </script>
</div>