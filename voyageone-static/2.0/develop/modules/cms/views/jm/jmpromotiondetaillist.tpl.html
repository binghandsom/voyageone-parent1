<div class="wrapper-md" ng-init="initialize()">
    <div class="vo_accordion vo_attr">
        <div class="panel-group">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title"><i class="glyphicon glyphicon-th"></i>&nbsp;活动详情</h4>
                </div>
                <div class="container-fluid m-t-xs m-b-xs">
                    <div class="col-sm-12">
                        <div class="col-sm-4">
                            <div class="form-horizontal">
                                <!--<div class="form-group">-->
                                <!--<label class="col-sm-3 control-label">Activity ID</label>-->
                                <!--<div class="col-sm-8">-->
                                <!--<input type="text" class="form-control" placeholder="12345" disabled>-->
                                <!--</div>-->
                                <!--</div>-->
                                <div class="form-group">
                                    <label class="col-sm-3 control-label" translate="TXT_PROMOTION_NAME"></label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="parentModel.name" disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 control-label" translate="TXT_PROMOTION_TIME"></label>

                                    <div class="col-sm-8 form-inline">
                                        <div class="input-group col-sm-4"><input type="text" class="form-control" ng-model="parentModel.activityStart"
                                                                                 disabled></div>
                                        &nbsp;~&nbsp;
                                        <div class="input-group col-sm-4"><input type="text" class="form-control" ng-model="parentModel.activityEnd"
                                                                                 disabled></div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label" translate="TXT_PRE_SALE_TIME"></label>

                                    <div class="col-sm-8 form-inline">
                                        <div class="input-group col-sm-4"><input type="text" class="form-control"
                                                                                 ng-model="parentModel.prePeriodStart" disabled></div>
                                        &nbsp;~&nbsp;
                                        <div class="input-group col-sm-4"><input type="text" class="form-control" ng-model="parentModel.prePeriodEnd"
                                                                                 disabled></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 control-label" translate="TXT_PROMOTION_PC_ID"></label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="parentModel.activityPcId" disabled/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label" translate="TXT_PROMOTION_APP_ID"></label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="parentModel.activityAppId" disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <hr>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">聚美类目</label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="searchInfo.categoryLv1Name">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">状态</label>

                                    <div class="col-sm-8" style="padding-left:0px">
                                        <label class="checkbox-inline c-checkbox" style="margin-left:4px">
                                            <input type="checkbox" name="synchState0" value="0" ng-model="searchInfo.synchState0"/>
                                            <span class="fa fa-check"></span>&nbsp;导入成功&nbsp;</label>
                                        <label class="checkbox-inline c-checkbox">
                                            <input type="checkbox" name="synchState1" value="1" ng-model="searchInfo.synchState1"/>
                                            <span class="fa fa-check"></span>&nbsp;待上传&nbsp;</label>
                                        <label class="checkbox-inline c-checkbox">
                                            <input type="checkbox" name="synchState2" value="2" ng-model="searchInfo.synchState2"/>
                                            <span class="fa fa-check"></span>&nbsp;上传成功&nbsp;</label>
                                        <label class="checkbox-inline c-checkbox">
                                            <input type="checkbox" name="synchState3" value="3" ng-model="searchInfo.synchState3"/>
                                            <span class="fa fa-check"></span>&nbsp;更新成功&nbsp;</label>
                                        <label class="checkbox-inline c-checkbox">
                                            <input type="checkbox" name="synchState4" value="4" ng-model="searchInfo.synchState4">
                                            <span class="fa fa-check"></span>&nbsp;上传异常&nbsp;</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">折扣</label>

                                    <div class="col-sm-8 form-inline">
                                        <div class="input-group col-sm-4"><input type="text" class="form-control" ng-model="searchInfo.beginDiscount"
                                                                                 placeholder="from"></div>
                                        &nbsp;~&nbsp;
                                        <div class="input-group col-sm-4"><input type="text" class="form-control" ng-model="searchInfo.endDiscount"
                                                                                 placeholder="to"></div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">价格</label>

                                    <div class="col-sm-8" style="padding-left:0px">
                                        <label class="checkbox-inline c-radio" style="margin-left:4px">
                                            <input name="priceType" type="radio" ng-model="searchInfo.priceType" value="msrp"><span
                                                class="fa fa-check"></span>&nbsp;MSRP</label>
                                        <label class="checkbox-inline c-radio">
                                            <input name="priceType" type="radio" ng-model="searchInfo.priceType" value="marketPrice"><span
                                                class="fa fa-check"></span>&nbsp;市场价</label>
                                        <label class="checkbox-inline c-radio">
                                            <input name="priceType" type="radio" ng-model="searchInfo.priceType" value="dealPrice"><span
                                                class="fa fa-check"></span>&nbsp;团购价</label>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label"></label>

                                    <div class="col-sm-8 form-inline">
                                        <div class="input-group col-sm-4"><input type="text" class="form-control" ng-model="searchInfo.beginPrice"
                                                                                 placeholder="from"/></div>
                                        &nbsp;~&nbsp;
                                        <div class="input-group col-sm-4"><input type="text" class="form-control" ng-model="searchInfo.endPrice"
                                                                                 placeholder="to"/></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">商品名称</label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="searchInfo.productNameCn"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">是否新建商品</label>

                                    <div class="col-sm-8">
                                        <select class="form-control" ng-model="searchInfo.state">
                                            <option value="">ALL</option>
                                            <option value="1">已上新再售</option>
                                            <option value="0">未上新</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">品牌</label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="searchInfo.brandName">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">颜色</label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="searchInfo.colorEn">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-sm-3 control-label">product code</label>

                                    <div class="col-sm-8">
                                        <input type="text" class="form-control" ng-model="searchInfo.productCode"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 text-center m-b-xs" ng-controller="popupCtrl">
                            <div class="form-horizontal form-inline">
                                <button class="btn btn-default" ng-click="clear()"><i class="fa fa-remove"></i>&nbsp;清除</button>
                                <button class="btn btn-vo" ng-click="search()"><i class="fa fa-search"></i>&nbsp;搜索</button>
                            </div><!-- .form-inline -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="box">
        <div class="form-inline pull-right m-b-xs" ng-controller="popupCtrl">
            <button class="btn btn-default" ng-click="openJmPromotionProductImport(parentModel,selectImport)"><i class="fa fa-reply-all"></i>&nbsp;导入
            </button>
            <div class="btn-group dropdown" uib-dropdown="">
                <button type="button" class="btn btn-default dropdown-toggle" uib-dropdown-toggle="" aria-haspopup="true" aria-expanded="false">
                    <i class="glyphicon glyphicon-share-alt"></i>&nbsp;导出&nbsp;<span class="caret"></span>
                </button>
                <ul uib-dropdown-menu="" class="ng-scope dropdown-menu">
                    <li><a href="" ng-click="addExport(0)">按上新模板</a></li>
                    <li><a href="" ng-click="addExport(1)">按价格修改模板</a></li>
                    <li><a href="" ng-click="addExport(2)">按专场模板</a></li>
                </ul>
            </div>
            <div class="btn-group dropdown" uib-dropdown="">
                <button type="button" class="btn btn-default dropdown-toggle" uib-dropdown-toggle="" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-arrow-circle-right"></i>&nbsp;全量操作&nbsp;<span class="caret"></span>
                </button>
                <ul uib-dropdown-menu="" class="ng-scope dropdown-menu">
                    <li><a href="" ng-click="deleteByPromotionId();">全量清空</a></li>
                    <li><a href="" ng-click="jmNewUpdateAll()">全量上传</a></li>
                    <!--<li><a href="">全量同步价格</a></li>-->
                    <li><a href="" ng-click="openDealExtension(modelAllUpdateDealEndTime)">全量Deal延期</a></li>
                </ul>
            </div>
            <div class="btn-group dropdown" uib-dropdown="">
                <button type="button" class="btn btn-default dropdown-toggle" uib-dropdown-toggle="" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-arrow-circle-right"></i>&nbsp;批量操作&nbsp;<span class="caret"></span>
                </button>
                <ul uib-dropdown-menu="" class="ng-scope dropdown-menu">
                    <li><a href="" ng-click="deleteByProductIdList()">批量清空</a></li>
                    <li><a href="" ng-click="jmNewByProductIdListInfo()">批量上传</a></li>
                    <!--<li><a href="">批量同步价格</a></li>-->
                    <li><a href="" ng-click="openDealExtension(modelUpdateDealEndTime)">批量Deal延期</a></li>
                    <!--<li><a href="">批量变更属性</a></li>-->
                    <!--<li><a href="" ng-click="openPriceModify('')">批量变更价格</a></li>-->
                </ul>
            </div>
            <div class="btn-group dropdown" uib-dropdown="" ng-controller="popupCtrl">
                <button type="button" class="btn btn-default dropdown-toggle" uib-dropdown-toggle="" aria-haspopup="true" aria-expanded="false">
                    <i class="fa fa-arrow-circle-right"></i>&nbsp;专场变更&nbsp;<span class="caret"></span>
                </button>
                <ul uib-dropdown-menu="" class="ng-scope dropdown-menu">
                    <li><a href="" ng-click="openJmPromotionDetail(parentModel)">编辑专场</a></li>

                </ul>
            </div>
        </div>
        <tabset class="tab-container vo_nav-tabs">
            <tab>
                <tab-heading>Product 详情</tab-heading>
                <div class="box">
                    <div class="box-body">
                        <div class="table-responsive">
                            <table class="table table-hover-new vo_table dropdown_table_main" style="width:2800px;margin-bottom:0px;table-layout: fixed;">
                                <thead>
                                <tr>
                                    <th class="mfb-xt3 text-left"><label class="checkbox-inline c-checkbox"><input type="checkbox"/><span
                                            class="fa fa-check"></span></label></th>
                                    <th class="text-left">上传状态</th>
                                    <th class="text-left">上新状态</th>
                                    <th class="text-left">错误消息</th>
                                    <th class="text-left">聚美类目</th>
                                    <th class="text-left">PC模块ID</th>
                                    <th class="text-left">APP模块ID</th>
                                    <th class="text-left">聚美产品ID</th>
                                    <th class="text-left">Product Code</th>
                                    <th class="text-left">聚美Hash ID</th>
                                    <th class="text-left">长标题</th>
                                    <th class="text-left">短标题</th>
                                    <th class="text-right">Price</th>
                                    <th class="text-right">最新团购价</th>
                                    <th class="text-left">Color</th>
                                    <th class="text-center">折扣</th>
                                    <th class="text-center">SKU数</th>
                                    <th class="text-left">Status</th>
                                    <th class="text-center">Action</th>
                                </tr>
                                </thead>
                                <tbody ng-if="vm.modelList.length">
                                <tr ng-repeat="model in vm.modelList" ng-controller="popupCtrl">
                                    <td class="mfb-xt3 text-left"><label class="checkbox-inline c-checkbox"><input type="checkbox"
                                                                                                                   ng-true-value="true"
                                                                                                                   ng-false-value="false"
                                                                                                                   ng-model="model.isChecked"><span
                                            class="fa fa-check"></span></label></td>
                                    <!--<td class="text-center"><img alt="100001" class="img-circle"></td>-->
                                    <td ng-if="model.updateState==0">未上传</td>
                                    <td ng-if="model.updateState==1">待上传</td>
                                    <td ng-if="model.updateState==2">上传成功</td>
                                    <td ng-if="model.updateState==3">上传失败</td>
                                    <!--<td title="{{model.errorMsg}}" >{{model.errorMsg.substr(0,30)}}</td>-->
                                    <td ng-if="model.synchState==0">未更新</td>
                                    <td ng-if="model.synchState==2">上新更新成功</td>
                                    <td ng-if="model.synchState==3">修改更新成功</td>
                                    <td ng-if="model.synchState==4">上传异常</td>
                                    <td>
                                        <small ng-controller="showPopoverCtrl" popover-html="showInfo('{{model.errorMsg}}')"
                                                popover-placement="left" class="ng-scope">
                                            <div class="table_main">
                                                <ul>
                                                    <li>{{model.errorMsg.substr(0,30)}}...</li>
                                                </ul>
                                            </div>
                                        </small>
                                    </td>
                                    <td class="mfb-xxx text-left">{{model.categoryLv1Name}}</td>
                                    <td class="text-left">{{model.pcId}}</td>
                                    <td class="text-left">{{model.appId}}</td>
                                    <td class="text-left">{{model.jumeiProductId}}</td>
                                    <td class="text-left">
<!--                                        <button class="btn btn-default btn-xs"
                                                ng-click="$parent.openJmProductDetail({'productCode': model.productCode, 'cmsBtJmPromotionId': parentModel.id}, openJmProductDetail)">
                                            {{model.productCode}}
                                        </button>-->
                                        <a href="javascript:void(0)"
                                           ng-click="$parent.openJmProductDetail({'productCode': model.productCode, 'cmsBtJmPromotionId': parentModel.id}, openJmProductDetail)">
                                            {{model.productCode}}
                                        </a>
                                    </td>
                                    <td class="text-left">{{model.jmHashId}}</td>
                                    <td class="text-left">{{model.productLongName}}</td>
                                    <td class="text-left">{{model.productShortName}}</td>
                                    <td class="text-right">
                                        <div class="table_main">
                                            <ul>
                                                <li>MSRP: {{model.msrp}}</li>
                                                <li>Deal Price：{{model.dealPrice}}</li>
                                                <li>market Price: {{model.marketPrice}}</li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td class="text-right"><input  class="text-right" ng-model="model.dealPrice" ng-change="model.isSave=true;"/></td>
                                    <td class="text-left">
                                        <div class="table_main">
                                            <ul>
                                                <li>{{model.colorEn}}</li>
                                                <li>{{model.attribute}}</li>
                                            </ul>
                                        </div>
                                    </td>
                                    <td class="text-center">{{model.discount}}</td>
                                    <td class="text-center">
                                        {{model.skuCount}}
                                        <!--<small ng-controller="showPopoverCtrl" popover-html="showInfo([&quot;1、CMS size《&#45;&#45;》聚美尺码：SKU《&#45;&#45;》聚美SKU&quot;,&quot;2、CMS size《&#45;&#45;》聚美尺码：SKU《&#45;&#45;》聚美SKU&quot;,&quot;3、CMS size《&#45;&#45;》聚美尺码：SKU《&#45;&#45;》聚美SKU&quot;])" popover-trigger="mouseenter" popover-placement="left" class="ng-scope">-->
                                        <!--<div class="table_main">-->
                                        <!--<ul>-->
                                        <!--<li>{{model.skuCount}}</li>-->
                                        <!--</ul>-->
                                        <!--</div>-->
                                        <!--</small>-->
                                    </td>
                                    <td class="text-left">{{model.state=="1"?"待再售":"在售"}}</td>
                                    <td class="text-center">
                                        <button title="重刷" class="btn btn-success btn-xs" ng-click="updateJM(model.id)"><i class="fa fa-refresh"></i>
                                        </button>
                                        <button title="编辑" class="btn btn-success btn-xs"
                                                ng-click="$parent.openJmProductDetail({productCode: model.productCode, cmsBtJmPromotionId: parentModel.id}, openJmProductDetail)">
                                            <i class="fa fa-pencil"></i></button>
                                        <button title="保存" ng-disabled="!model.isSave" class="btn btn-vo btn-xs" ng-click="updateDealPrice(model);"><i
                                                class="glyphicon glyphicon-floppy-disk"></i></button>
                                        <button title="删除" class="btn btn-danger btn-xs" ng-click="del(model)"><i class="fa fa-trash-o"></i></button>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <div if-no-rows="vm.modelList.length"></div>
                        </div>
                    </div>
                    <div class="col-sm-12 m-t-lg m-b-lg">
                        <vpagination config="dataPageOption"></vpagination>
                    </div>
                </div>
            </tab>

            <tab ng-click="searchImport()">
                <tab-heading>导入任务一览</tab-heading>
                <div class="table-responsive">
                    <table class="table table-hover-new vo_table" style="table-layout: fixed;">
                        <thead>
                        <tr>
                            <th class="text-left">导出文件名</th>
                            <th class="text-center">成功件数</th>
                            <th class="text-center">失败件数</th>
                            <th class="text-left">导入开始时间</th>
                            <th class="text-left">导入结束时间</th>
                            <th class="text-left">异常信息Code</th>
                            <th class="text-left">失败文件</th>
                            <th class="text-center">操作</th>
                        </tr>
                        </thead>
                        <tbody ng-if="vm.cmsBtJmPromotionImportTaskList.length">
                        <tr ng-repeat="model in vm.cmsBtJmPromotionImportTaskList">
                            <td class="text-left">{{model.fileName}}</td>
                            <td class="text-center">{{model.successRows}}</td>
                            <td class="text-center">{{model.failuresRows}}</td>
                            <td class="text-left">{{model.beginTime}}</td>
                            <td class="text-left">{{model.endTime}}</td>
                            <td class="text-left"><textarea class="form-control no-resize ng-pristine ng-untouched ng-valid ng-not-empty" rows="3">{{model.errorMsg}}</textarea>
                            </td>
                            <td class="text-left"><a ng-click="downloadImportErrorExcel(model.id);">{{model.failuresFileName}}</a></td>
                            <td class="text-center">
                                <button title="下载" ng-click="downloadImportExcel(model.id)" class="btn btn-danger btn-xs"><i
                                        class="fa fa-download"></i></button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </tab>
            <tab ng-click="searchExport()">
                <tab-heading>导出任务一览</tab-heading>
                <div class="table-responsive">
                    <table class="table table-hover-new vo_table" style="table-layout: fixed;">
                        <thead>
                        <tr>
                            <th class="text-left">导出模板类型</th>
                            <th class="text-left">导出文件名</th>
                            <th class="text-center">成功件数</th>
                            <th class="text-left">导出开始时间</th>
                            <th class="text-left">导出结束时间</th>
                            <th class="text-center">异常信息Code</th>
                            <th class="text-center">操作</th>
                        </tr>
                        </thead>
                        <tbody ng-if="vm.cmsBtJmPromotionExportTaskList.length">
                        <tr ng-repeat="model in vm.cmsBtJmPromotionExportTaskList">
                            <td class="text-left" ng-if="model.templateType==0">上新模板</td>
                            <td class="text-left" ng-if="model.templateType==1">价格修改</td>
                            <td class="text-left" ng-if="model.templateType==2">专场模板</td>
                            <td class="text-left">{{model.fileName}}</td>
                            <td class="text-center">{{model.successRows}}</td>
                            <td class="text-left">{{model.beginTime}}</td>
                            <td class="text-left">{{model.endTime}}</td>
                            <td class="text-center"><textarea class="form-control no-resize ng-pristine ng-untouched ng-valid ng-not-empty" rows="3">{{model.errorMsg}}</textarea>
                            </td>
                            <td class="text-center">
                                <button title="下载" ng-disabled="!model.isExport" ng-click="downloadExportExcel(model.id);"
                                        class="btn btn-danger btn-xs"><i class="fa fa-download"></i></button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </tab>
        </tabset>
    </div>
</div>
</div><!-- end .wrapper-md -->