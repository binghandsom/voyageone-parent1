<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.voyageone.wms.sql">
    <select id="cms_bt_product_getProductByCode" resultType="com.voyageone.wms.modelbean.external.WmsProductBean">
        SELECT
            product_id,
            channel_id,
            CODE,
            NAME,
            product_type_id,
            color,
            msrp,
            modified
        FROM
            voyageone_cms.cms_bt_product
        WHERE
            channel_id = #{order_channel_id}
        AND `code` = #{code};
    </select>

    <select id="cms_mt_product_type_hasProductType" resultType="int">
        SELECT
            count(1)
        FROM
            voyageone_cms.cms_mt_product_type
        WHERE
            product_type_id = #{product_type_id}
        AND channel_id = #{order_channel_id}
    </select>

    <insert id="cms_bt_product_insertProduct">
        INSERT INTO voyageone_cms.cms_bt_product (
            product_id,
            channel_id,
            CODE,
            NAME,
            product_type_id,
            color,
            msrp,
            url_key,
            created,
            creater,
            modified,
            modifier
        )
        VALUES
            (
                NULL,
                #{channel_id},
                #{code},
                #{name},
                #{product_type_id},
                #{color},
                #{msrp},
                "",
                now(),
                #{creater},
                now(),
                #{modifier})
    </insert>

    <update id="cms_bt_product_updateProduct">
        UPDATE voyageone_cms.cms_bt_product
        SET channel_id = #{channel_id},
            CODE = #{code},
            NAME = #{name},
            product_type_id = #{product_type_id},
            color = #{color},
            msrp = #{msrp},
            modified = now(),
            modifier = #{modifier}
        WHERE
            product_id = #{product_id}
        AND modified = #{modified}
    </update>

    <select id="cms_mt_product_type_getAllProductTypes" resultType="com.voyageone.wms.modelbean.external.WmsProductTypeBean">
        SELECT product_type_id,
            channel_id,
            product_type_short_name,
            product_type_name
        FROM voyageone_cms.cms_mt_product_type WHERE channel_id = #{order_channel_id}
    </select>
</mapper>