// Generated by CoffeeScript 1.9.3

/*
  @Name: SetMatchValueService
  @Description: 主数据属性匹配第三方品牌数据，属性值匹配设定弹窗的数据交换
  @Date: 2015-09-06 17:23:47

  @User: Jonas
  @Version: 0.0.1
 */
define(['modules/cms/cms.module'], function(cmsModule) {
  return cmsModule.service('SetMatchValueService', (function() {
    _Class.$inject = ['$q', 'cmsAction', 'ajaxService'];

    function _Class($q, cmsAction, ajaxService) {
      this.$q = $q;
      this.feedValuesCache = {};
      this.actions = cmsAction.match.props;
      this.post = (function(_this) {
        return function(url, param) {
          return ajaxService.ajaxPost(param, _this.actions.root + url);
        };
      })(this);
    }

    _Class.prototype.getFeedValues = function(feedConfig) {
      var values;
      values = this.feedValuesCache[feedConfig.cfg_val1];
      if (values && !values.length) {
        return this.$q(function(goon) {
          return goon(values);
        });
      }
      return this.post(this.actions.getFeedValues, feedConfig).then((function(_this) {
        return function(res) {
          return _this.feedValuesCache[feedConfig.cfg_val1] = res.data;
        };
      })(this));
    };

    _Class.prototype.getPropOptions = function(prop_id) {
      return this.post(this.actions.getPropOptions, {
        prop_id: prop_id
      });
    };

    _Class.prototype.addMapping = function(mapping) {
      return this.post(this.actions.addMapping, mapping);
    };

    _Class.prototype.setMapping = function(mapping) {
      return this.post(this.actions.setMapping, mapping);
    };

    _Class.prototype.delMapping = function(mapping) {
      return this.post(this.actions.delMapping, mapping);
    };

    _Class.prototype.getMappings = function(prop_id) {
      return this.post(this.actions.getMappings, {
        prop_id: prop_id
      });
    };

    _Class.prototype.getDefValue = function(prop) {
      return this.post(this.actions.getDefault, prop);
    };

    return _Class;

  })());
});
