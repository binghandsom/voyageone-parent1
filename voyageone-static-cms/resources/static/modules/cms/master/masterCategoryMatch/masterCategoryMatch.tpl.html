<div ng-controller="masterCategoryMatchController" ng-init="initialize()" ng-cloak="" >
<div class="bg-light lter b-b wrapper-md vo_page_header clearfix">
  <div class="row">
    <div class="vo_page_title col-sm-1"><h1 class="m-n font-thin h3 text-vo">类目列表</h1></div><!-- .vo_page_title -->
        <div class="col-sm-5 pull-right">
		<button ng-if="filterByCategory == false && filterByProp == false" ng-click = "filterPropDisMatchCategory()" class="btn m-b-xs btn-sm btn-success fa fa-list-alt pull-right"> 属性匹配未完成类目</button>
        <button ng-if="filterByCategory == false && filterByProp == true" ng-click = "filterPropDisMatchCategory()" class="btn m-b-xs btn-sm btn-success fa fa-list-alt pull-right"> 全部类目</button>
		<button ng-if="filterByCategory == false && filterByProp == false" ng-click = "filterDisMatchCategory()" class="btn m-b-xs btn-sm btn-success fa fa-list-alt pull-right"> 未匹配类目</button>
        <button ng-if="filterByCategory == true  && filterByProp == false" ng-click = "filterDisMatchCategory()" class="btn m-b-xs btn-sm btn-success fa fa-list-alt pull-right"> 全部类目</button>
          
        </div><!-- .col-sm-5 -->
  </div><!-- .row -->

</div><!-- .wrapper-md .vo_page_header -->
 <div  class="wrapper-md">
  <div class="row">
    <!--店铺展示-->
    <div class="col-lg-12">
      <div>
        <tabset class="tab-container vo_nav-tabs">
          <tab>
            <tab-heading><i class="fa fa-codepen"></i> 所有类目列表</tab-heading>
            
		    <div ng-show="showMainCategory" id="master-category-match" style="position: absolute;">
				<ul ng-include="'categoryNav'"></ul>
			</div>
            <div class="panel vo_panel tab_panel fixed">
              <!-- .table-responsive -->
              <div class="table-responsive">
                <table datatable="ng" class="table table-striped hover b-t b-b vo_table">
                  <thead>
                  <tr>
                    <th class="vo_a_ce col-sm-1">序号</th>
                    <th class="col-sm-2">类目匹配</th>
                    <th class="col-sm-3">CMS类目名称</th>
                    <th class="col-sm-3">主类目名称</th>
                    <th class="col-sm-1 text-center">&nbsp;保存 / 继承</th>
                    <th class="col-sm-1 text-center">&nbsp;&nbsp;&nbsp;忽略</th>
                    <th class="vo_a_ce col-sm-1">属性匹配</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr ng-repeat="cmsCategory in cmsCategoryList">
                    <td class="vo_a_ce">{{$index + 1}}</td>
                    <td class="fixed">
                      <div class="form-inline">
                        <div  class="btn-group">
                          <button type="button" ng-click="showMasterCategoryDiv(this,$event)" class="btn btn-primary dropdown-toggle btn-sm fa">
                          &nbsp;类目匹配
                            <span class="caret"></span>
                            <span class="sr-only">Split button!</span>
                          </button>
                        </div>
                        </div>
                    </td>
                    <td ng-bind="cmsCategory.cmsCategoryPath"></td>
                    <td><font ng-bind="cmsCategory.mainCategoryPath" ng-class="cmsCategory.inheritClass"></font></td>
                    <td class="text-center">
                      <div ng-if="cmsCategory.isSave" ><button type="button" ng-click="save(cmsCategory)" class="btn btn-vo btn-xs"><i class="fa fa-save"></i></button></div>
                      <div ng-if="cmsCategory.isExtend" ><button type="button" ng-click="save(cmsCategory)" class="btn btn-vo btn-xs"><i class="fa fa-arrow-down"></i></button></div>
                    </td>
                    <td class="text-center"><label class="checkbox-inline c-checkbox needsclick"><input type="checkbox" ng-change="change(cmsCategory)" ng-model="cmsCategory.isMatch"><span class="fa fa-check"></span></label></td>
                    <td><button ng-if="cmsCategory.mainCategoryId > 0 && cmsCategory.isPropMatch" type="button" ng-click = "propertyMatch(cmsCategory)" class="btn btn-primary btn-sm fa fa-equalizer fa-building">&nbsp;属性匹配</button></td>
                  </tr>
                  </tbody>
                </table>
              </div><!-- .table-responsive -->
            </div> <!-- .panel -->
            <div class="pull-right-xs"><button type="button" ng-click="saveAll(cmsCategoryList)" class="btn btn-vo btn-xl fa fa-save">&nbsp;保存</button></div>
            </tab>

        </tabset><!-- tabset -->

      </div><!-- tabs ng-controller -->
    </div><!-- .col-lg-12 -->
  </div><!-- .row -->
</div><!-- end .wrapper-md -->
</div>
<script id="categoryNav" type="text/ng-template">
	<li class="active" ng-repeat="item in masterCategoryList">
		<a ng-if="item.subCategories.length == 0" ng-click="setMasterCategory(item)">
			<span ng-bind="item.categoryName"></span>
		</a>
		<a ng-if="item.subCategories.length">
				<span class="pull-right text-muted">
					<i class="fa fa-fw fa-angle-right text"></i>
					<i class="fa fa-fw fa-angle-right text-active"></i>
				</span>
			<span ng-bind="item.categoryName"></span>
		</a>
		<ul ng-if="item.subCategories.length" ng-include="'categoryNav'" ng-init="masterCategoryList = item.subCategories"></ul>
	</li>
</script>